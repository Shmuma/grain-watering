#+STARTUP: fold

Планы, задачи и заметки по системе автоматического увлажнения зерна

* notes
** forward
ssh -R 11155:localhost:22 yurix@hadoop.yandex.ru
password: compaq
** port
com2 == /dev/ttyS1
* done
** DONE инициализация демона
   CLOSED: [2008-02-09 Сбт 00:47]
** DONE составить первичный словарь команд ядра
   CLOSED: [2008-02-09 Сбт 04:55]
** DONE соединение с COM-портом
   CLOSED: [2008-02-09 Сбт 04:55]
** DONE просмотреть документацию
   CLOSED: [2008-02-09 Сбт 04:55]
** DONE спросить про сомнительные команды
   CLOSED: [2008-02-22 Птн 00:50]
** DONE инфраструктура интерпретатора команд
   CLOSED: [2008-02-10 Вск 02:13]
** DONE Реализовать остальные команды работы с системой
   CLOSED: [2008-02-20 Срд 01:21]
** DONE сокет команд
   CLOSED: [2008-02-20 Срд 01:21]
** DONE Убрать нафиг команду getpower state
   CLOSED: [2008-02-22 Птн 11:19]
** DONE Исправить команду слива воды из системы
   CLOSED: [2008-02-22 Птн 11:33]
** DONE Исправить протоколирование обменов с портом
   CLOSED: [2008-02-22 Птн 14:23]
** DONE сдампить обмены при получении идентификатора
   CLOSED: [2008-02-22 Птн 14:23]
** DONE реализация таймаута получения данных
   CLOSED: [2008-02-28 Чтв 08:41]
** DONE [#A] Ошибка с выеданием 100% CPU
   CLOSED: [2008-02-28 Чтв 09:55]
** DONE Подключение контроллера к сокету
   CLOSED: [2008-03-01 Сбт 16:09]
** DONE Первичное прикручивание sqlite
   CLOSED: [2008-03-01 Сбт 17:30]
** DONE Команда автоматического управления
   CLOSED: [2008-03-11 Втр 21:22]
** DONE реализовать команду sleep
   CLOSED: [2008-03-16 Вск 11:02]
** DONE [#B] Изменить timeout'ы
   CLOSED: [2008-03-16 Вск 11:34]
** DONE [#A] зависание команды help
   CLOSED: [2008-03-16 Вск 12:11]
** DONE реализовать выполнение скриптов
   CLOSED: [2008-03-16 Вск 13:19]
** DONE [#B] исправить все возвращаемые значения команд на беззнаковые
   CLOSED: [2008-03-16 Вск 13:27]
** DONE Ввести параметр Kfs
   CLOSED: [2008-03-16 Вск 23:00]
** DONE Преобразование результатов по формулам
  CLOSED: [2008-03-16 Вск 23:00]
1. [X] давление воды
2. [X] расход воды
3. [X] температура зерна
** DONE Включение-выключение датчиков наличия зерна
   CLOSED: [2008-03-20 Чтв 01:46]
** DONE Закладка проверки системы
   CLOSED: [2008-03-20 Чтв 02:12]
** DONE [#A] исправить ошибку с остановкой воды для второго этапа
   CLOSED: [2008-03-23 Вск 00:48]
** DONE Странности с переключением кнопок в меню "Проверка"
   CLOSED: [2008-03-23 Вск 01:29]
** DONE Изменить расход воды в формуле с 7200 на 3600
   CLOSED: [2008-03-23 Вск 01:46]
** DONE Преобразование возвращаемых значений по формулам
   CLOSED: [2008-03-23 Вск 02:14]
** DONE Ошибка с получением значений датчиков (неверный индекс)
   CLOSED: [2008-03-23 Вск 02:22]
** DONE Реализации цикла контроля параметров
   CLOSED: [2008-03-25 Втр 00:07]
** DONE переделать кнопки запуска-остановки для каждого этапа
   CLOSED: [2008-04-08 Втр 22:07]
** DONE Общая кнопка остановки системы
   CLOSED: [2008-04-11 Птн 00:14]
** DONE Обработка данных цикла контроля параметров в интерфейсе
   CLOSED: [2008-04-11 Птн 00:14]
** DONE Отображение состояния БШУ
   CLOSED: [2008-04-11 Птн 00:14]
** DONE набросок интерфейса конфигурирования системы
   CLOSED: [2008-04-11 Птн 00:15]
** DONE Исправить ошибку с unsigned char в слове состояния
   CLOSED: [2008-04-11 Птн 00:57]
** DONE Исправить ошибку со сдвигом в getHigh
   CLOSED: [2008-04-11 Птн 00:56]
** DONE Передача параметров системы демону
   CLOSED: [2008-04-13 Вск 00:22]
** DONE Редактирование параметров
   CLOSED: [2008-04-13 Вск 01:04]
** DONE Сохранение параметров системы в базе
   CLOSED: [2008-04-13 Вск 02:16]
** DONE Редактирование таблиц коэффициентов
  CLOSED: [2008-04-15 Втр 19:19]
1. [X] влажность
2. [ ] расход зерна
3. [ ] натура зерна
4. [ ] 
5. [ ] 
** DONE Пароль администратора
   CLOSED: [2008-04-15 Втр 20:41]
** DONE Пароль конфигурирования
   CLOSED: [2008-04-15 Втр 20:41]
** DONE Учитывать таблицы при расчете параметров
   CLOSED: [2008-04-20 Вск 11:25]
** DONE Вычисление уставки
   CLOSED: [2008-04-20 Вск 16:55]
** DONE Выключить наличие датчиков зерна по умолчанию
   CLOSED: [2008-04-20 Вск 17:48]
** DONE [#A] Реализовать отладочный режим в демоне
   CLOSED: [2008-04-20 Вск 22:21]
** DONE [#A] Переключать активный пункт обратно при ошибке авторизации
   CLOSED: [2008-04-20 Вск 22:26]
** DONE Вывод на экран значений текущей влажности, целевого расхода и уставки
   CLOSED: [2008-04-20 Вск 22:55]
** DONE Закладка с датчиками
   CLOSED: [2008-04-21 Пнд 09:50]
** DONE Сохранение параметров в базе
   CLOSED: [2008-04-22 Втр 00:28]
** DONE [#A] Ошибка с обработкой списков после включения автоматического режима
   CLOSED: [2008-04-22 Втр 00:57]
** DONE Набор исторических данных для отображения
   CLOSED: [2008-04-22 Втр 02:11]
** DONE Протокол передачи исторических данных
   CLOSED: [2008-04-22 Втр 02:11]
** DONE [#A] Оценка скорости роста объемов данных
  CLOSED: [2008-04-22 Втр 10:00]
начало: 2:10, управение выполняется всеми этапами
окончание: 10:00
размер: 5 Mb (history 59000)
** DONE [#A] Узнать про тип значений в таблице коэффициентов
   CLOSED: [2008-04-25 Птн 09:01]
** DONE Спросить про последний коэффициент в формуле расчета текущей влажности зерна
   CLOSED: [2008-04-25 Птн 09:01]
** DONE Команда управления режимом протоколирования
   CLOSED: [2008-04-26 Сбт 12:52]
** DONE Реализация цикла управления
   CLOSED: [2008-04-26 Сбт 12:52]
** DONE Сохраниение данных цикла контроля параметров
   CLOSED: [2008-04-26 Сбт 12:52]
* DONE Получение данных по параметрам
  CLOSED: [2008-04-27 Вск 12:35]
* DONE Получение данных по истории
  CLOSED: [2008-04-27 Вск 12:35]
* DONE Отображение графиков с историей
  CLOSED: [2008-04-27 Вск 12:35]
* DONE Законы изменения параметров в модели системы
  CLOSED: [2008-04-27 Вск 12:40]
* TODO Реализация полуавтоматического режима с явным указанием уставки
* TODO Сохранения истории системных событий
* TODO Сохранение истории промывки
* Проверки в цикле контроля параметров
Если любая из этих проверок срабатывает (кроме ручного режима и слива
воды), необходимо остановить воду и вывести сообщение
** TODO Проверять поток зерна
если поток меньше установленного в параметрах, то считаем что зерна нет
** TODO Проверять переход ручной режим
** TODO Проверка наличия связи с контроллером в цикле контроля параметров
Выполняем connect
Выполняем getstatus
Если обе команды завершились по таймауту, то считаем что контроллер
недоступен
Если вторая команда вернула manual, то переходим в ручной режим

** TODO Проверка напряжения на БШУ в цикле контроля параметров
** TODO Проверка промывки системы в цикле контроля параметров
** TODO Проверка слива воды

* DONE Новая формула расчета температуры
  CLOSED: [2008-04-26 Сбт 04:58]
k=0.0097
n=992
a=(t*k*n)/(3.3-t*k)
T=(a-1000)/3.86
* DONE Ввод параметров в формуле расчета температуры
  CLOSED: [2008-04-26 Сбт 04:58]
* DONE В сообщении о запуске воды номер этапа + 1
  CLOSED: [2008-04-26 Сбт 12:01]
* DONE В таблицах ключ вводится в десятичном виде
  CLOSED: [2008-04-26 Сбт 12:01]
* DONE Коэффициент ПК(nat) вычисляется от натуры зерна
  CLOSED: [2008-04-26 Сбт 12:03]
* DONE Последний коэффициент не нужен
  CLOSED: [2008-04-26 Сбт 12:03]
* DONE Сохранение уставки в архив
  CLOSED: [2008-04-26 Сбт 12:30]
* DONE В параметры добавить номер БШУ и выводить его в контроле
  CLOSED: [2008-04-26 Сбт 12:51]
* DONE Сделать аппроксимацию данных таблиц по ключевым точкам
  CLOSED: [2008-04-26 Сбт 13:36]
* DONE Условия сборки в pro файле для alt linux
  CLOSED: [2008-04-26 Сбт 13:38]
* DONE Реализовать режим калибровки датчиков
  CLOSED: [2008-04-26 Сбт 15:24]
* DONE Реализовать выбор режима работы этапа (автоматический, полуавтоматический)
  CLOSED: [2008-04-26 Сбт 22:13]
* DONE При выводе сообщений, новые сообщения должны появлятся сверху и дополнятся временем
  CLOSED: [2008-04-26 Сбт 22:26]
* DONE Возможность отправки и получения значений в шестнадцатеричном коде (в gui и демоне)
  CLOSED: [2008-04-26 Сбт 22:46]
* DONE Если не включено ни одного этапа делать недоступной кнопку параметров
  CLOSED: [2008-04-26 Сбт 23:30]
Сейчас если без выбора этапов нажать apply, приложение валится
* DONE Добавление результатов измерений в список данных
  CLOSED: [2008-04-27 Вск 12:40]
* DONE В цикле контроля и вычисления параметров выполнять доп.проверки [5/5] [100%]
  CLOSED: [2008-04-27 Вск 13:49]
1. [X] команда синхронизации (connect)
2. [X] проверка режима работы
3. [X] проверка включен ли БШУ
4. [X] проверка наличия воды
5. [X] проверка наличия зерна
В случае ошибки на одном из шагов, выводить диагностику и дальнейшие
измерения не выполнять
* DONE Проблема с сохранением давления воды
  CLOSED: [2008-04-27 Вск 14:03]
* DONE Режим промывки
  CLOSED: [2008-04-27 Вск 14:04]
* DONE Промывка фильтра
  CLOSED: [2008-04-28 Пнд 00:44]
* DONE Промывка этапов
  CLOSED: [2008-04-28 Пнд 00:44]
* DONE Слив воды
  CLOSED: [2008-04-28 Пнд 00:44]
* DONE В графиках сделать кнопку ресета даты на текущую
  CLOSED: [2008-04-29 Втр 00:38]
* DONE На любые управляющие воздействия и события в системе необходимо выводить сообщение
  CLOSED: [2008-04-29 Втр 01:20]
* NEXT Переделать отображение этапов
* TODO Перенести кнопки запуска и останова этапа
* TODO Переделать обработку кнопок пуск и стоп этапов
При нажатии пуск выполняется старт работы в выбраном режиме и запуск воды
При нажатии стоп Останавливать воду

* TODO На экран выводить текущую влажность (после корректировки)
Измеренная влажность не выводится
* TODO Review всех операций с массивами на предмет проверки индексов
* TODO Перевод сообщений на русский
* TODO Придумать способ обработки промывки системы
Проблема в том, что после выдачи команды на промывку, мы должны
дождаться её завершения. Сейчас команда отваливается по таймауту, что
не есть хорошо. Либо выключать нафиг таймаут и тупо ждать завершения
промывки, либо вносить изменения в логику работы демона.
* TODO Проверить все барьеры
При пропадании зерна или питания БШУ выключать воду, и т.д.
* TODO Сохранение результатов промывок в истории
* TODO Сохранение всех сообщений в истории
* TODO Учет автоматического и полуавтоматического режимов
* TODO Проверить правильность реализции команды слива воды
При тестировании команда завершалась по таймауту.
* TODO Сделать сравнение версии микрокода (getDeviceID) с константой в программе
