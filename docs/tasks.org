#+STARTUP: fold

Планы, задачи и заметки по системе автоматического увлажнения зерна

* notes
** forward
ssh -R 11155:localhost:22 yurix@hadoop.yandex.ru
password: compaq
** port
com2 == /dev/ttyS1
* done
** DONE инициализация демона
   CLOSED: [2008-02-09 Сбт 00:47]
** DONE составить первичный словарь команд ядра
   CLOSED: [2008-02-09 Сбт 04:55]
** DONE соединение с COM-портом
   CLOSED: [2008-02-09 Сбт 04:55]
** DONE просмотреть документацию
   CLOSED: [2008-02-09 Сбт 04:55]
** DONE спросить про сомнительные команды
   CLOSED: [2008-02-22 Птн 00:50]
** DONE инфраструктура интерпретатора команд
   CLOSED: [2008-02-10 Вск 02:13]
** DONE Реализовать остальные команды работы с системой
   CLOSED: [2008-02-20 Срд 01:21]
** DONE сокет команд
   CLOSED: [2008-02-20 Срд 01:21]
** DONE Убрать нафиг команду getpower state
   CLOSED: [2008-02-22 Птн 11:19]
** DONE Исправить команду слива воды из системы
   CLOSED: [2008-02-22 Птн 11:33]
** DONE Исправить протоколирование обменов с портом
   CLOSED: [2008-02-22 Птн 14:23]
** DONE сдампить обмены при получении идентификатора
   CLOSED: [2008-02-22 Птн 14:23]
** DONE реализация таймаута получения данных
   CLOSED: [2008-02-28 Чтв 08:41]
** DONE [#A] Ошибка с выеданием 100% CPU
   CLOSED: [2008-02-28 Чтв 09:55]
** DONE Подключение контроллера к сокету
   CLOSED: [2008-03-01 Сбт 16:09]
** DONE Первичное прикручивание sqlite
   CLOSED: [2008-03-01 Сбт 17:30]
** DONE Команда автоматического управления
   CLOSED: [2008-03-11 Втр 21:22]
** DONE реализовать команду sleep
   CLOSED: [2008-03-16 Вск 11:02]
** DONE [#B] Изменить timeout'ы
   CLOSED: [2008-03-16 Вск 11:34]
** DONE [#A] зависание команды help
   CLOSED: [2008-03-16 Вск 12:11]
** DONE реализовать выполнение скриптов
   CLOSED: [2008-03-16 Вск 13:19]
** DONE [#B] исправить все возвращаемые значения команд на беззнаковые
   CLOSED: [2008-03-16 Вск 13:27]
** DONE Ввести параметр Kfs
   CLOSED: [2008-03-16 Вск 23:00]
** DONE Преобразование результатов по формулам
  CLOSED: [2008-03-16 Вск 23:00]
1. [X] давление воды
2. [X] расход воды
3. [X] температура зерна
** DONE Включение-выключение датчиков наличия зерна
   CLOSED: [2008-03-20 Чтв 01:46]
** DONE Закладка проверки системы
   CLOSED: [2008-03-20 Чтв 02:12]
** DONE [#A] исправить ошибку с остановкой воды для второго этапа
   CLOSED: [2008-03-23 Вск 00:48]
** DONE Странности с переключением кнопок в меню "Проверка"
   CLOSED: [2008-03-23 Вск 01:29]
** DONE Изменить расход воды в формуле с 7200 на 3600
   CLOSED: [2008-03-23 Вск 01:46]
** DONE Преобразование возвращаемых значений по формулам
   CLOSED: [2008-03-23 Вск 02:14]
** DONE Ошибка с получением значений датчиков (неверный индекс)
   CLOSED: [2008-03-23 Вск 02:22]
** DONE Реализации цикла контроля параметров
   CLOSED: [2008-03-25 Втр 00:07]
** DONE переделать кнопки запуска-остановки для каждого этапа
   CLOSED: [2008-04-08 Втр 22:07]
** DONE Общая кнопка остановки системы
   CLOSED: [2008-04-11 Птн 00:14]
** DONE Обработка данных цикла контроля параметров в интерфейсе
   CLOSED: [2008-04-11 Птн 00:14]
** DONE Отображение состояния БШУ
   CLOSED: [2008-04-11 Птн 00:14]
** DONE набросок интерфейса конфигурирования системы
   CLOSED: [2008-04-11 Птн 00:15]
** DONE Исправить ошибку с unsigned char в слове состояния
   CLOSED: [2008-04-11 Птн 00:57]
** DONE Исправить ошибку со сдвигом в getHigh
   CLOSED: [2008-04-11 Птн 00:56]
** DONE Передача параметров системы демону
   CLOSED: [2008-04-13 Вск 00:22]
** DONE Редактирование параметров
   CLOSED: [2008-04-13 Вск 01:04]
** DONE Сохранение параметров системы в базе
   CLOSED: [2008-04-13 Вск 02:16]
** DONE Редактирование таблиц коэффициентов
  CLOSED: [2008-04-15 Втр 19:19]
1. [X] влажность
2. [ ] расход зерна
3. [ ] натура зерна
4. [ ] 
5. [ ] 
** DONE Пароль администратора
   CLOSED: [2008-04-15 Втр 20:41]
** DONE Пароль конфигурирования
   CLOSED: [2008-04-15 Втр 20:41]
** DONE Учитывать таблицы при расчете параметров
   CLOSED: [2008-04-20 Вск 11:25]
** DONE Вычисление уставки
   CLOSED: [2008-04-20 Вск 16:55]
** DONE Выключить наличие датчиков зерна по умолчанию
   CLOSED: [2008-04-20 Вск 17:48]
** DONE [#A] Реализовать отладочный режим в демоне
   CLOSED: [2008-04-20 Вск 22:21]
** DONE [#A] Переключать активный пункт обратно при ошибке авторизации
   CLOSED: [2008-04-20 Вск 22:26]
** DONE Вывод на экран значений текущей влажности, целевого расхода и уставки
   CLOSED: [2008-04-20 Вск 22:55]
** DONE Закладка с датчиками
   CLOSED: [2008-04-21 Пнд 09:50]
** DONE Сохранение параметров в базе
   CLOSED: [2008-04-22 Втр 00:28]
** DONE [#A] Ошибка с обработкой списков после включения автоматического режима
   CLOSED: [2008-04-22 Втр 00:57]
** DONE Набор исторических данных для отображения
   CLOSED: [2008-04-22 Втр 02:11]
** DONE Протокол передачи исторических данных
   CLOSED: [2008-04-22 Втр 02:11]
** DONE [#A] Оценка скорости роста объемов данных
  CLOSED: [2008-04-22 Втр 10:00]
начало: 2:10, управение выполняется всеми этапами
окончание: 10:00
размер: 5 Mb (history 59000)
** DONE [#A] Узнать про тип значений в таблице коэффициентов
   CLOSED: [2008-04-25 Птн 09:01]
** DONE Спросить про последний коэффициент в формуле расчета текущей влажности зерна
   CLOSED: [2008-04-25 Птн 09:01]
** DONE Команда управления режимом протоколирования
   CLOSED: [2008-04-26 Сбт 12:52]
** DONE Реализация цикла управления
   CLOSED: [2008-04-26 Сбт 12:52]
** DONE Сохраниение данных цикла контроля параметров
   CLOSED: [2008-04-26 Сбт 12:52]
** DONE Получение данных по параметрам
   CLOSED: [2008-04-27 Вск 12:35]
** DONE Получение данных по истории
   CLOSED: [2008-04-27 Вск 12:35]
** DONE Отображение графиков с историей
   CLOSED: [2008-04-27 Вск 12:35]
** DONE Законы изменения параметров в модели системы
   CLOSED: [2008-04-27 Вск 12:40]
** DONE Проверки в цикле контроля параметров
  CLOSED: [2008-05-04 Вск 14:53]
Если любая из этих проверок срабатывает (кроме ручного режима и слива
воды), необходимо остановить воду и вывести сообщение
*** DONE Проверять поток зерна
   CLOSED: [2008-05-04 Вск 14:53]
если поток меньше установленного в параметрах, то считаем что зерна нет
*** DONE Проверять переход ручной режим
    CLOSED: [2008-05-04 Вск 14:53]
*** DONE Проверка наличия связи с контроллером в цикле контроля параметров
   CLOSED: [2008-05-04 Вск 14:53]
Выполняем connect
Выполняем getstatus
Если обе команды завершились по таймауту, то считаем что контроллер
недоступен
Если вторая команда вернула manual, то переходим в ручной режим
*** DONE Проверка напряжения на БШУ в цикле контроля параметров
    CLOSED: [2008-05-04 Вск 14:53]
*** DONE Проверка промывки системы в цикле контроля параметров
    CLOSED: [2008-05-04 Вск 14:53]
*** DONE Проверка слива воды
    CLOSED: [2008-05-04 Вск 14:53]
** DONE Новая формула расчета температуры
  CLOSED: [2008-04-26 Сбт 04:58]
k=0.0097
n=992
a=(t*k*n)/(3.3-t*k)
T=(a-1000)/3.86
** DONE Ввод параметров в формуле расчета температуры
   CLOSED: [2008-04-26 Сбт 04:58]
** DONE В сообщении о запуске воды номер этапа + 1
   CLOSED: [2008-04-26 Сбт 12:01]
** DONE В таблицах ключ вводится в десятичном виде
   CLOSED: [2008-04-26 Сбт 12:01]
** DONE Коэффициент ПК(nat) вычисляется от натуры зерна
   CLOSED: [2008-04-26 Сбт 12:03]
** DONE Последний коэффициент не нужен
   CLOSED: [2008-04-26 Сбт 12:03]
** DONE Сохранение уставки в архив
   CLOSED: [2008-04-26 Сбт 12:30]
** DONE В параметры добавить номер БШУ и выводить его в контроле
   CLOSED: [2008-04-26 Сбт 12:51]
** DONE Сделать аппроксимацию данных таблиц по ключевым точкам
   CLOSED: [2008-04-26 Сбт 13:36]
** DONE Условия сборки в pro файле для alt linux
   CLOSED: [2008-04-26 Сбт 13:38]
** DONE Реализовать режим калибровки датчиков
   CLOSED: [2008-04-26 Сбт 15:24]
** DONE Реализовать выбор режима работы этапа (автоматический, полуавтоматический)
   CLOSED: [2008-04-26 Сбт 22:13]
** DONE При выводе сообщений, новые сообщения должны появлятся сверху и дополнятся временем
   CLOSED: [2008-04-26 Сбт 22:26]
** DONE Возможность отправки и получения значений в шестнадцатеричном коде (в gui и демоне)
   CLOSED: [2008-04-26 Сбт 22:46]
** DONE Если не включено ни одного этапа делать недоступной кнопку параметров
  CLOSED: [2008-04-26 Сбт 23:30]
Сейчас если без выбора этапов нажать apply, приложение валится
** DONE Добавление результатов измерений в список данных
   CLOSED: [2008-04-27 Вск 12:40]
** DONE В цикле контроля и вычисления параметров выполнять доп.проверки [5/5] [100%]
  CLOSED: [2008-04-27 Вск 13:49]
1. [X] команда синхронизации (connect)
2. [X] проверка режима работы
3. [X] проверка включен ли БШУ
4. [X] проверка наличия воды
5. [X] проверка наличия зерна
В случае ошибки на одном из шагов, выводить диагностику и дальнейшие
измерения не выполнять
** DONE Проблема с сохранением давления воды
   CLOSED: [2008-04-27 Вск 14:03]
** DONE Режим промывки
   CLOSED: [2008-04-27 Вск 14:04]
** DONE Промывка фильтра
   CLOSED: [2008-04-28 Пнд 00:44]
** DONE Промывка этапов
   CLOSED: [2008-04-28 Пнд 00:44]
** DONE Слив воды
   CLOSED: [2008-04-28 Пнд 00:44]
** DONE В графиках сделать кнопку ресета даты на текущую
   CLOSED: [2008-04-29 Втр 00:38]
** DONE На любые управляющие воздействия и события в системе необходимо выводить сообщение
   CLOSED: [2008-04-29 Втр 01:20]
** DONE Статический размер этапов
   CLOSED: [2008-05-02 Птн 21:32]
** DONE Включение-отключение отрисовки этапов
   CLOSED: [2008-05-02 Птн 21:32]
** DONE Растровая картинка с этапом
   CLOSED: [2008-05-03 Сбт 12:11]
** DONE svg картинка с областями вывода данных и кнопками
   CLOSED: [2008-05-03 Сбт 12:11]
** DONE Убирать фиксированый размер для неактивных этапов
   CLOSED: [2008-05-03 Сбт 12:38]
** DONE Переделать отображение этапов
   CLOSED: [2008-05-03 Сбт 12:38]
** DONE Убрать команду isgrainpresent
   CLOSED: [2008-05-03 Сбт 12:42]
** DONE Разобраться с состоянием grain и grainlow
   CLOSED: [2008-05-03 Сбт 13:08]
** DONE Перенести кнопки запуска и останова этапа
   CLOSED: [2008-05-03 Сбт 22:53]
** DONE Переделать обработку кнопок пуск и стоп этапов
  CLOSED: [2008-05-03 Сбт 22:53]
При нажатии пуск выполняется старт работы в выбраном режиме и запуск воды
При нажатии стоп Останавливать воду

** DONE На экран выводить текущую влажность (после корректировки)
  CLOSED: [2008-05-04 Вск 00:39]
Измеренная влажность не выводится
** DONE Проверить вычисление уставки
   CLOSED: [2008-05-04 Вск 00:56]
** DONE Сделать отображение блока фильтра через svg
   CLOSED: [2008-05-04 Вск 11:50]
** DONE Review всех операций с массивами на предмет проверки индексов
   CLOSED: [2008-05-04 Вск 12:09]
** DONE Кнопки управления влажностью
   CLOSED: [2008-05-04 Вск 14:53]
** DONE Сохранение всех сообщений в истории
   CLOSED: [2008-05-04 Вск 16:53]
** DONE Сохранения истории системных событий
   CLOSED: [2008-05-04 Вск 16:53]
* DONE Проверка неактивности этапов при выполнении промывки
  CLOSED: [2008-05-05 Пнд 13:17]
* DONE Придумать способ обработки промывки системы
  CLOSED: [2008-05-06 Втр 00:01]
Проблема в том, что после выдачи команды на промывку, мы должны
дождаться её завершения. Сейчас команда отваливается по таймауту, что
не есть хорошо. Либо выключать нафиг таймаут и тупо ждать завершения
промывки, либо вносить изменения в логику работы демона.
* DONE Моделирование промывки в модели системы
  CLOSED: [2008-05-06 Втр 00:01]
* DONE Получение при старте gui информации о промывке
  CLOSED: [2008-05-06 Втр 00:39]
* DONE Проверить все команды демона GUI на предмет ожидания ответа
  CLOSED: [2008-05-06 Втр 00:48]
* DONE Сохранение истории промывки
  CLOSED: [2008-05-06 Втр 02:10]
* DONE Сохранение результатов промывок в истории
  CLOSED: [2008-05-06 Втр 02:10]
* DONE Реализация полуавтоматического режима с явным указанием потока воды
  CLOSED: [2008-05-06 Втр 17:16]
* DONE Учет автоматического и полуавтоматического режимов
  CLOSED: [2008-05-06 Втр 17:16]
* DONE Увеличить размер поля для заданого потока воды
  CLOSED: [2008-05-06 Втр 22:00]
* DONE Решить как быть с переводом сообщений от демона
  CLOSED: [2008-05-07 Срд 00:21]
* DONE Проверку и вывод сообщения о недостаточном давлении воды
  CLOSED: [2008-05-07 Срд 02:33]
* DONE Разобраться с переменной _sensors в shell
  CLOSED: [2008-05-07 Срд 10:18]
* DONE Поломалась история
  CLOSED: [2008-05-07 Срд 12:58]
* DONE Проверить все барьеры
  CLOSED: [2008-05-07 Срд 13:11]
При пропадании зерна или питания БШУ выключать воду, и т.д.
* DONE Раскрасить кнопки этапов
  CLOSED: [2008-05-07 Срд 13:39]
* DONE Проверить правильность реализции команды слива воды
  CLOSED: [2008-05-07 Срд 15:06]
При тестировании команда завершалась по таймауту.
* DONE Узнать что за значение выводится над трубой  
  CLOSED: [2008-05-07 Срд 23:52]
Разность между текущей влажностью и заданной. Пилять, никогда бы не
подумал ;).
* DONE Узнать как обрабатывать режим без датчиков и чем отличается   
  CLOSED: [2008-05-07 Срд 23:52]
Должен быть отдельный режим работы этапа -- без датчиков влажности. В
нем измеряется только расход зерна, входная влажность задана. 
* DONE Умножать значения в формуле требуемого потока воды на 1000
  CLOSED: [2008-05-07 Срд 23:56]
* DONE Запятую после BSU в checkTick
  CLOSED: [2008-05-08 Чтв 00:15]
* DONE Не проверять недостаток воды в этапе
  CLOSED: [2008-05-08 Чтв 00:15]
* DONE Не проверять барьеры в течении двух минут после старта этапа
  CLOSED: [2008-05-08 Чтв 00:38]
* DONE Выводить нулевые значения вместо отрицательных
  CLOSED: [2008-05-08 Чтв 00:41]
* DONE Не измерять давление воды без запущеных этапов
  CLOSED: [2008-05-08 Чтв 00:51]
* MAYBE Сделать картинки без датчиков
* MAYBE Сделать картинки полуавтоматического режима
* TODO Перевод сообщений на русский
* TODO Сделать перевод сообщений в демоне gui
* NEXT Проверить процедуру слива воды
* TODO Дополнительный режим работы этапа - с фиксированой входной влажностью
* TODO Выводить значение разницы влажностей над трубой
